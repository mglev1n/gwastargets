[{"path":"https://mglev1n.github.io/gwastargets/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 gwastargets authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Getting Started with gwastargets","text":"gwastargets provides functions building reproducible multi-cohort GWAS meta-analysis pipelines using targets framework. supports binary (case/control) quantitative traits. typical workflow : Assemble manifest data frame describing cohort files Call generate_gwas_meta_pipeline() produce _targets.R code Paste output _targets.R run targets::tar_make() pipeline functions (prep_gwas(), meta_analyze_ivw(), etc.) also available interactive use outside targets.","code":""},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-1-build-a-cohort-manifest","dir":"Articles","previous_headings":"","what":"Step 1: Build a cohort manifest","title":"Getting Started with gwastargets","text":"manifest data frame one row per cohort × ancestry combination. must contain five columns: generate_gwas_meta_pipeline() validates manifest generating code — error required columns missing study values duplicated, warn path files exist disk.","code":"library(gwastargets)  manifest <- data.frame(   path     = c(     \"/project/data/UKBB_EUR.txt.gz\",     \"/project/data/MVP_EUR.txt.gz\",     \"/project/data/BBJ_EAS.txt.gz\"   ),   file     = c(\"UKBB_EUR.txt.gz\", \"MVP_EUR.txt.gz\", \"BBJ_EAS.txt.gz\"),   cohort   = c(\"UKBB\",            \"MVP\",            \"BBJ\"),   ancestry = c(\"EUR\",             \"EUR\",            \"EAS\"),   study    = c(\"UKBB_EUR\",        \"MVP_EUR\",        \"BBJ_EAS\"),   stringsAsFactors = FALSE )"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-2-generate-the-pipeline","dir":"Articles","previous_headings":"","what":"Step 2: Generate the pipeline","title":"Getting Started with gwastargets","text":"output self-contained block R code ready paste _targets.R. includes: manifest serialized tibble::tribble() call tar_map() block running per-cohort preparation LDSC heritability LDSC genetic correlation QC targets (one per ancestry ≥ 2 cohorts) Per-ancestry IVW meta-analysis targets Manhattan plots loci -populations IVW meta-analysis MR-MEGA MDS Cohort overview table precision plot","code":"code <- generate_gwas_meta_pipeline(   trait       = \"CAD\",   trait_type  = \"binary\",   # or \"quantitative\"   n_col       = \"EffectiveN\",  # use \"N\" for quantitative traits   manifest_df = manifest )  # Review the generated code cat(code)"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-3-per-cohort-preparation-prep_gwas","dir":"Articles","previous_headings":"","what":"Step 3: Per-cohort preparation (prep_gwas)","title":"Getting Started with gwastargets","text":"cohort’s summary statistics pass prep_gwas(), : Cleans raw file via clean_gwas() (header harmonization + tidyGWAS QC) Validates expected columns present declared trait_type Matches variants HapMap 3 SNP list via snp_match_munge() Estimates LDSC intercept applies SE correction intercept > 1 Writes .parquet file standardized columns including SE_ldsc_adjusted output parquet file contains original cleaned columns plus:","code":"# Typically called inside a targets pipeline, but works interactively too out_path <- prep_gwas(   sumstats_file = \"/project/data/UKBB_EUR.txt.gz\",   hm3           = hm3_snps,         # data frame with SNP, A1, A2   ancestry      = \"EUR\",   output_path   = \"Data/CAD/prepped_sumstats\",   trait_type    = \"binary\",   n_col         = EffectiveN         # bare name, not quoted )"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-4-cohort-qc-with-summarize_sumstats","dir":"Articles","previous_headings":"","what":"Step 4: Cohort QC with summarize_sumstats","title":"Getting Started with gwastargets","text":"meta-analysis, inspect per-cohort statistics: binary traits, summary includes n_cases, n_controls, n_effective, n_total. quantitative traits, n_total returned. include SNP counts, EAF range, median SE — used build cohort overview table precision plot generated pipeline.","code":"prepped_files <- list.files(\"Data/CAD/prepped_sumstats\", full.names = TRUE,                             pattern = \"\\\\.parquet$\")  summary_tbl <- summarize_sumstats(prepped_files, trait_type = \"binary\")"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-5-ivw-meta-analysis","dir":"Articles","previous_headings":"","what":"Step 5: IVW meta-analysis","title":"Getting Started with gwastargets","text":"meta_analyze_ivw() runs fixed-effects inverse-variance weighted meta-analysis across prepped parquet files, one chromosome time: Output columns include: B, SE, p_value, z_score, EAF, n_contributions, N (binary traits: CaseN, ControlN, EffectiveN), plus heterogeneity statistics Q, Q_df, Q_pval, I2.","code":"meta_results <- meta_analyze_ivw(   parquet_files = prepped_files,   trait_type    = \"binary\",   se_col        = SE_ldsc_adjusted,   # use LDSC-adjusted SE   chromosomes   = 1:22,   min_mac       = 100                  # minimum minor allele count filter )"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-6-loci-extraction","dir":"Articles","previous_headings":"","what":"Step 6: Loci extraction","title":"Getting Started with gwastargets","text":"Calls gwasRtools::get_loci() LD-based clumping gwasRtools::get_nearest_gene() gene annotation. Returns tibble one row per independent locus columns lead variant, gene, association statistics.","code":"loci <- extract_loci(meta_results)"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"step-7-mr-mega-mds","dir":"Articles","previous_headings":"","what":"Step 7: MR-MEGA MDS","title":"Getting Started with gwastargets","text":"multi-ancestry analyses, MR-MEGA requires matrix per-study effect estimates common variants. extract_common_variants() identifies variants present studies MAF threshold, calculate_mr_mega_mds() computes MDS coordinates resulting effect heterogeneity matrix: MDS coordinates passed covariates MR-MEGA model ancestry-driven effect heterogeneity.","code":"common_vars <- extract_common_variants(   parquet_files        = prepped_files,   trait_type           = \"binary\",   select_per_mb_window = TRUE   # LD-thin to ~1 variant/Mb )  mds <- calculate_mr_mega_mds(common_vars) # mds$pc_coordinates: study × PC matrix # mds$distance_matrix: pairwise effect-size distance matrix"},{"path":"https://mglev1n.github.io/gwastargets/articles/gwastargets.html","id":"raw-summary-statistics-format","dir":"Articles","previous_headings":"","what":"Raw summary statistics format","title":"Getting Started with gwastargets","text":"prep_gwas() accepts wide range column naming conventions. harmonize_sumstats_headers() (called internally clean_gwas()) maps common aliases standard names used throughout package: Additional mappings can passed via column_names argument prep_gwas().","code":""},{"path":"https://mglev1n.github.io/gwastargets/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"First Last. Author, maintainer.","code":""},{"path":"https://mglev1n.github.io/gwastargets/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Last F (2026). gwastargets: GWAS Meta-Analysis Pipeline Functions. R package version 0.2.0, https://mglev1n.github.io/gwastargets/.","code":"@Manual{,   title = {gwastargets: GWAS Meta-Analysis Pipeline Functions},   author = {First Last},   year = {2026},   note = {R package version 0.2.0},   url = {https://mglev1n.github.io/gwastargets/}, }"},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"gwastargets","dir":"","previous_headings":"","what":"gwastargets: GWAS Meta-Analysis Pipeline Functions","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"gwastargets provides suite functions building reproducible multi-cohort GWAS meta-analysis pipelines using targets framework. supports binary (case/control) quantitative traits handles full workflow raw summary statistics meta-analysis downstream quality-control.","code":""},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"","code":"# install.packages(\"pak\") pak::pkg_install(\"mglev1n/gwastargets\")"},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"package organized around two complementary use cases: 1. Generating targets pipeline — given cohort manifest trait metadata, produce complete _targets.R code reproducible analysis: 2. Using pipeline functions directly — stage available standalone exported function interactive use integration existing workflows:","code":"library(gwastargets)  manifest <- data.frame(   path     = c(\"/data/UKBB_EUR.txt.gz\", \"/data/MVP_AFR.txt.gz\", \"/data/BBJ_EAS.txt.gz\"),   file     = c(\"UKBB_EUR.txt.gz\",       \"MVP_AFR.txt.gz\",       \"BBJ_EAS.txt.gz\"),   cohort   = c(\"UKBB\",                  \"MVP\",                  \"BBJ\"),   ancestry = c(\"EUR\",                   \"AFR\",                  \"EAS\"),   study    = c(\"UKBB_EUR\",              \"MVP_AFR\",              \"BBJ_EAS\"),   stringsAsFactors = FALSE )  code <- generate_gwas_meta_pipeline(   trait       = \"CAD\",   trait_type  = \"binary\",   n_col       = \"EffectiveN\",   manifest_df = manifest )  cat(code)"},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"pipeline-architecture","dir":"","previous_headings":"","what":"Pipeline Architecture","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"","code":"Raw summary stats (per cohort)         │         ▼    prep_gwas()          ← clean, match HM3, LDSC intercept correction         │         ├──── ldsc_h2()            per-cohort heritability (via ldscr)         │         ├──── summarize_sumstats() per-cohort QC table         │         ├──── meta_analyze_ivw()   per-ancestry IVW meta-analysis         │         └── extract_loci()         │         └──── meta_analyze_ivw()   all-populations IVW meta-analysis                   ├── extract_loci()                   └── extract_common_variants()                             └── calculate_mr_mega_mds()"},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"manifest-requirements","dir":"","previous_headings":"","what":"Manifest requirements","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"generate_gwas_meta_pipeline() validates manifest generating code. required columns : Additional columns preserved serialized output can used downstream.","code":""},{"path":"https://mglev1n.github.io/gwastargets/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related packages","title":"gwastargets: GWAS Meta-Analysis Pipeline Functions","text":"ldscr — LDSC heritability genetic correlation R tidyGWAS — GWAS summary statistics cleaning gwasRtools — GWAS loci extraction annotation targets — reproducible pipeline toolkit","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"Computes multidimensional scaling (MDS) coordinates study-level effect allele frequency (EAF) data. approach follows MR-MEGA method (Mägi et al. 2017): population-genetic distance matrix computed EAF values, double-centred, decomposed via SVD produce principal coordinates.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"","code":"calculate_mr_mega_mds(   common_variants_data,   pcCount = 4,   chr_col = CHR,   pos_col = POS_38,   rsid_col = RSID,   ea_col = EffectAllele,   oa_col = OtherAllele,   eaf_col = minor_af,   file_col = file )"},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"common_variants_data data frame (long format) one row per variant × study combination. Must contain columns identified chr_col, pos_col, ea_col, oa_col, eaf_col, file_col. Typically output extract_common_variants(). pcCount Number principal coordinates return. Default 4. chr_col Bare column name chromosome. Default CHR. pos_col Bare column name position. Default POS_38. rsid_col Bare column name rsid. Default RSID. ea_col Bare column name effect allele. Default EffectAllele. oa_col Bare column name allele. Default OtherAllele. eaf_col Bare column name EAF. Default minor_af. file_col Bare column name study/file identifier. Default file.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"named list elements: pc_coordinates Data frame MDS coordinates (pcCount columns). distance_matrix Population-genetic distance matrix. centered_distance_matrix Double-centred distance matrix. eigenvalues Eigenvalues SVD. eaf_matrix Wide EAF matrix (variants × studies). used_variants Variants complete EAF data. studies Character vector study names. summary List n_studies, n_variants_used, n_variants_total, pc_count.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"Calculate MR-MEGA multidimensional scaling coordinates","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"Mägi R, et al. (2017). Trans-ethnic meta-regression genome-wide association studies accounting ancestry increases power discovery improves fine-mapping resolution. Hum Mol Genet, 26(18), 3639–3650.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/calculate_mr_mega_mds.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate MR-MEGA MDS coordinates from allele frequency data — calculate_mr_mega_mds","text":"","code":"if (FALSE) { # \\dontrun{ common <- extract_common_variants(files, trait_type = \"binary\") mds    <- calculate_mr_mega_mds(common) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"Harmonises column headers via harmonize_sumstats_headers(), applies minor-allele frequency pre-filter (EFF_ALL_FREQ 0.001 0.999), passes result tidyGWAS::tidyGWAS() full QC. tidyGWAS log file copied logging_path.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"","code":"clean_gwas(sumstats_file, logging_path, ...)"},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"sumstats_file Path raw GWAS summary statistics file (plain text .gz). logging_path Directory tidyGWAS log file saved. ... Additional arguments forwarded tidyGWAS::tidyGWAS().","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"cleaned summary statistics object returned tidyGWAS::tidyGWAS().","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"Clean GWAS summary statistics","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/clean_gwas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clean GWAS summary statistics with tidyGWAS — clean_gwas","text":"","code":"if (FALSE) { # \\dontrun{ cleaned <- clean_gwas(   sumstats_file = \"my_gwas.txt.gz\",   logging_path  = \"logs/\" ) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract variants common to all GWAS studies — extract_common_variants","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"Opens multiple parquet files, filters variants minor allele frequency maf_threshold, returns variants present every file. Optionally selects one variant per megabase window per chromosome LD-thinned analyses.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"","code":"extract_common_variants(   parquet_files,   trait_type,   maf_threshold = 0.05,   select_per_mb_window = FALSE,   window_size_mb = 1,   seed = NULL,   eaf_col = EAF,   chr_col = CHR,   pos_col = POS_38,   rsid_col = RSID,   ea_col = EffectAllele,   oa_col = OtherAllele,   n_col = N )"},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"parquet_files Character vector paths parquet files. trait_type \"binary\" \"quantitative\" (required). maf_threshold Minimum minor allele frequency. Default 0.05. select_per_mb_window Logical; TRUE, select one variant per window_size_mb Mb window per chromosome. Default FALSE. window_size_mb Window size megabases thinning. Default 1. seed Random seed reproducible window selection. Default NULL. eaf_col Bare column name EAF. Default EAF. chr_col Bare column name chromosome. Default CHR. pos_col Bare column name position. Default POS_38. rsid_col Bare column name rsid. Default RSID. ea_col Bare column name effect allele. Default EffectAllele. oa_col Bare column name allele. Default OtherAllele. n_col Bare column name N. Default N.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"tibble::tibble() columns file, chromosome, position, rsid, effect allele, allele, minor_af. One row per variant × study combination.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"Extract common variants present studies","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_common_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract variants common to all GWAS studies — extract_common_variants","text":"","code":"if (FALSE) { # \\dontrun{ common <- extract_common_variants(   parquet_files = c(\"study1.parquet\", \"study2.parquet\"),   trait_type    = \"binary\" ) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract genome-wide significant independent loci — extract_loci","title":"Extract genome-wide significant independent loci — extract_loci","text":"Filters meta-analysis data frame genome-wide significant variants, identifies independent loci via gwasRtools::get_loci(), annotates lead variant nearest gene via gwasRtools::get_nearest_gene(). Returns empty tibble::tibble() variants pass p-value threshold.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract genome-wide significant independent loci — extract_loci","text":"","code":"extract_loci(   df,   snp_col = RSID,   chr_col = CHR,   pos_col = POS_38,   maf_col = EAF,   beta_col = B,   se_col = SE,   p_col = p_value,   p_threshold = 5e-08,   build = 38,   ... )"},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract genome-wide significant independent loci — extract_loci","text":"df data frame meta-analysis results (e.g. output meta_analyze_ivw()). snp_col Bare column name rsid. Default RSID. chr_col Bare column name chromosome. Default CHR. pos_col Bare column name position. Default POS_38. maf_col Bare column name minor allele frequency. Default EAF. beta_col Bare column name effect size. Default B. se_col Bare column name SE. Default SE. p_col Bare column name p-value. Default p_value. p_threshold Genome-wide significance threshold. Default 5e-8. build Genome build gene annotation (37 38). Default 38. ... Additional arguments forwarded gwasRtools::get_loci().","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract genome-wide significant independent loci — extract_loci","text":"tibble::tibble() independent lead variants gene annotations, empty tibble variants pass threshold.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract genome-wide significant independent loci — extract_loci","text":"Extract genome-wide significant loci","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/extract_loci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract genome-wide significant independent loci — extract_loci","text":"","code":"if (FALSE) { # \\dontrun{ loci <- extract_loci(meta_results, p_threshold = 5e-8) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"Generates complete targets / tarchetypes pipeline character string, ready pasted _targets.R file. generated code covers per-cohort preparation, LDSC heritability estimation, per-ancestry -populations IVW meta-analysis, loci extraction, Manhattan plots, MR-MEGA MDS. Validates trait_type, n_col, manifest_df generating code. manifest serialized tibble::tribble() call generated output pipeline self-contained.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"","code":"generate_gwas_meta_pipeline(   trait,   trait_type,   n_col,   manifest_df,   hm3_path,   crew_controller = NULL,   output_base_dir = \"Data\" )"},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"trait Trait name used target names (e.g. \"CAD\"). trait_type \"binary\" \"quantitative\" (required, default). n_col Sample size column: \"EffectiveN\" binary traits, \"N\" quantitative traits (required, default). manifest_df data frame describing cohort files include. Required columns: path (full path raw summary statistics file), file (basename file), cohort (cohort label), ancestry (ancestry label, e.g. \"EUR\"), study (unique human-readable identifier; must contain spaces special characters; need include ancestry). tar_name column ({study}_{ancestry}) automatically added used tar_map target name ancestry-based target selectors work reliably. Additional columns preserved serialized output. hm3_path Path LDSC HapMap3 SNP list file (e.g. w_hm3.snplist). Required. crew_controller Name crew controller use resource-intensive targets (meta_ALL meta_common_variants_ALL). NULL (default), resources block added targets. output_base_dir Base output directory intermediate files. Default \"Data\".","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"length-1 character string containing valid R code defining targets pipeline.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"Generate targets GWAS meta-analysis pipeline","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/generate_gwas_meta_pipeline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate targets pipeline code for GWAS meta-analysis — generate_gwas_meta_pipeline","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- data.frame(   path     = c(\"/data/UKBB_EUR.txt.gz\", \"/data/MVP_AFR.txt.gz\"),   file     = c(\"UKBB_EUR.txt.gz\",       \"MVP_AFR.txt.gz\"),   cohort   = c(\"UKBB\",                  \"MVP\"),   ancestry = c(\"EUR\",                   \"AFR\"),   study    = c(\"UKBB_EUR\",              \"MVP_AFR\"),   stringsAsFactors = FALSE ) cat(generate_gwas_meta_pipeline(\"CAD\", trait_type = \"binary\",                                 n_col = \"EffectiveN\", manifest_df = manifest,                                 hm3_path = \"/path/to/w_hm3.snplist\")) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"Reads GWAS summary statistics text file (plain .gz) renames columns standardised vocabulary. Unmapped columns left unchanged.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"","code":"harmonize_sumstats_headers(input_file)"},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"input_file Path plain-text gzip-compressed summary statistics file readable data.table::fread().","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"data.table::data.table() harmonised column names.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"Harmonize summary statistics column headers","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/harmonize_sumstats_headers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Harmonize GWAS summary statistics headers — harmonize_sumstats_headers","text":"","code":"if (FALSE) { # \\dontrun{ dt <- harmonize_sumstats_headers(\"my_gwas.txt.gz\") } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"Performs fixed-effects inverse-variance weighted (IVW) meta-analysis across multiple cohort parquet files. Processes chromosome via meta_analyze_chromosome(), applies minor allele count (MAC) filter, returns heterogeneity statistics (Q, I2) alongside weighted effect estimates.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"","code":"meta_analyze_ivw(   parquet_files,   trait_type,   chromosomes = 1:22,   min_mac = 100,   se_col = SE,   beta_col = B,   eaf_col = EAF,   chr_col = CHR,   pos_col = POS_38,   rsid_col = RSID,   ea_col = EffectAllele,   oa_col = OtherAllele,   n_col = N,   effective_n_col = EffectiveN,   case_n_col = CaseN,   control_n_col = ControlN )"},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"parquet_files Character vector paths prepared parquet files (output prep_gwas()). trait_type \"binary\" \"quantitative\" (required). chromosomes Integer vector chromosomes process. Default 1:22. min_mac Minimum minor allele count. Variants threshold excluded. Default 100. se_col Bare column name SE. Default SE. beta_col Bare column name effect size. Default B. eaf_col Bare column name EAF. Default EAF. chr_col Bare column name chromosome. Default CHR. pos_col Bare column name position. Default POS_38. rsid_col Bare column name rsid. Default RSID. ea_col Bare column name effect allele. Default EffectAllele. oa_col Bare column name allele. Default OtherAllele. n_col Bare column name total N. Default N. effective_n_col Bare column name effective N. Default EffectiveN. case_n_col Bare column name case N. Default CaseN. control_n_col Bare column name control N. Default ControlN.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"tibble::tibble() columns: CHR, POS_38, RSID, EffectAllele, OtherAllele, B, SE, p_value, z_score, EAF, n_contributions, N, EffectiveN, Q, Q_df, Q_pval, I2. Binary traits additionally include CaseN ControlN.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"IVW meta-analysis across cohorts","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/meta_analyze_ivw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inverse-variance weighted GWAS meta-analysis — meta_analyze_ivw","text":"","code":"if (FALSE) { # \\dontrun{ meta <- meta_analyze_ivw(   parquet_files = c(\"study1.parquet\", \"study2.parquet\"),   trait_type    = \"binary\",   chromosomes   = 1:22 ) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare and QC GWAS summary statistics — prep_gwas","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"high-level wrapper runs full per-cohort preparation pipeline: (1) cleans raw file via clean_gwas(), (2) validates trait-type columns via assert_trait_columns(), (3) matches HapMap3 SNPs via snp_match_munge(), (4) estimates LDSC intercept via ldscr::ldsc_h2(), (5) writes .parquet file LDSC-adjusted (unadjusted) SE, Z, P columns.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"","code":"prep_gwas(   sumstats_file,   hm3,   ancestry,   output_path,   trait_type,   n_col,   dbsnp_path = \"Data/dbSNP155\",   logging_path = \"Data/logs\",   ... )"},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"sumstats_file Path raw GWAS summary statistics file. hm3 Data frame HapMap3 SNPs columns SNP, A1, A2. ancestry Ancestry label (e.g. \"EUR\"). Passed ldscr::ldsc_h2(). output_path Directory output parquet file written. trait_type \"binary\" \"quantitative\" (required, default). n_col Bare column name sample size. Use EffectiveN binary traits N quantitative traits (required, default). dbsnp_path Path dbSNP155 reference. Default \"Data/dbSNP155\". logging_path Directory tidyGWAS log files. Default \"Data/logs\". ... Additional arguments forwarded clean_gwas().","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"file path written parquet file (invisibly).","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"Prepare GWAS summary statistics meta-analysis","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/prep_gwas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare and QC GWAS summary statistics — prep_gwas","text":"","code":"if (FALSE) { # \\dontrun{ out <- prep_gwas(   sumstats_file = \"cohort1.txt.gz\",   hm3           = hm3_snps,   ancestry      = \"EUR\",   output_path   = \"Data/prepped\",   trait_type    = \"binary\",   n_col         = EffectiveN ) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":null,"dir":"Reference","previous_headings":"","what":"Match GWAS SNPs against a reference SNP list — snp_match_munge","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"Matches variants sumstats info_snp rsid, effect allele (a1), allele (a0). Optionally removes ambiguous SNPs (/T C/G), performs strand flipping, reverses allele coding.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"","code":"snp_match_munge(   sumstats,   info_snp,   strand_flip = TRUE,   join_by_pos = TRUE,   remove_dups = TRUE,   match.min.prop = 0.2,   return_flip_and_rev = FALSE )"},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"sumstats data frame GWAS summary statistics. Must contain columns rsid, a0, a1, beta. info_snp data frame reference SNPs. Must contain columns rsid, a0, a1. strand_flip Logical; TRUE (default), remove ambiguous SNPs (/T, C/G) attempt strand flipping. join_by_pos Logical; TRUE, also join position. Default TRUE. remove_dups Logical; TRUE (default), remove duplicate rsid entries matching. match.min.prop Minimum proportion variants must match. Default 0.2. error raised fewer variants match. return_flip_and_rev Logical; TRUE, retain _FLIP_ _REV_ indicator columns output. Default FALSE.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"data frame matched variants ordered chromosome.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"Match munge SNPs reference panel","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/snp_match_munge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Match GWAS SNPs against a reference SNP list — snp_match_munge","text":"","code":"if (FALSE) { # \\dontrun{ matched <- snp_match_munge(   sumstats = my_sumstats,   info_snp = hm3_snps ) } # }"},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize GWAS summary statistics — summarize_sumstats","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"Opens one parquet files Arrow dataset, computes per-file summary statistics (SNP count, EAF range, median SE, etc.), appends binary-trait columns (n_cases, n_controls, n_effective) trait_type = \"binary\".","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"","code":"summarize_sumstats(   parquet_files,   trait_type,   min_mac = 100,   se_col = SE,   beta_col = B,   eaf_col = EAF,   chr_col = CHR,   pos_col = POS_38,   rsid_col = RSID,   n_col = N,   effective_n_col = EffectiveN,   case_n_col = CaseN,   control_n_col = ControlN )"},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"parquet_files Character vector paths parquet files. trait_type \"binary\" \"quantitative\" (required). min_mac Minimum minor allele count filter. Default 100. se_col Bare column name SE. Default SE. beta_col Bare column name effect size. Default B. eaf_col Bare column name effect allele frequency. Default EAF. chr_col Bare column name chromosome. Default CHR. pos_col Bare column name position. Default POS_38. rsid_col Bare column name rsid. Default RSID. n_col Bare column name total N. Default N. effective_n_col Bare column name effective N. Default EffectiveN. case_n_col Bare column name case N. Default CaseN. control_n_col Bare column name control N. Default ControlN.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"tibble::tibble() one row per file summary columns.","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"Summarize GWAS summary statistics files","code":""},{"path":"https://mglev1n.github.io/gwastargets/reference/summarize_sumstats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize GWAS summary statistics — summarize_sumstats","text":"","code":"if (FALSE) { # \\dontrun{ summary <- summarize_sumstats(   parquet_files = c(\"study1.parquet\", \"study2.parquet\"),   trait_type    = \"binary\" ) } # }"}]
