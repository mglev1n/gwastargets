% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prep_gwas.R
\name{prep_gwas}
\alias{prep_gwas}
\title{Prepare and QC GWAS summary statistics}
\usage{
prep_gwas(
  sumstats_file,
  hm3,
  ancestry,
  output_path,
  trait_type,
  n_col,
  dbsnp_path = "Data/dbSNP155",
  logging_path = "Data/logs",
  ...
)
}
\arguments{
\item{sumstats_file}{Path to a raw GWAS summary statistics file.}

\item{hm3}{Data frame of HapMap3 SNPs with columns \code{SNP}, \code{A1}, \code{A2}.}

\item{ancestry}{Ancestry label (e.g. \code{"EUR"}). Passed to
\code{\link[ldscr:ldsc_h2]{ldscr::ldsc_h2()}}.}

\item{output_path}{Directory where the output parquet file is written.}

\item{trait_type}{\code{"binary"} or \code{"quantitative"} (required, no default).}

\item{n_col}{Bare column name for sample size. Use \code{EffectiveN} for binary
traits and \code{N} for quantitative traits (required, no default).}

\item{dbsnp_path}{Path to the dbSNP155 reference. Default
\code{"Data/dbSNP155"}.}

\item{logging_path}{Directory for tidyGWAS log files. Default
\code{"Data/logs"}.}

\item{...}{Additional arguments forwarded to \code{\link[=clean_gwas]{clean_gwas()}}.}
}
\value{
The file path of the written parquet file (invisibly).
}
\description{
A high-level wrapper that runs the full per-cohort preparation pipeline:
(1) cleans the raw file via \code{\link[=clean_gwas]{clean_gwas()}}, (2) validates trait-type columns
via \code{assert_trait_columns()}, (3) matches to HapMap3 SNPs via
\code{\link[=snp_match_munge]{snp_match_munge()}}, (4) estimates the LDSC intercept via
\code{\link[ldscr:ldsc_h2]{ldscr::ldsc_h2()}}, and (5) writes an \code{.parquet} file with LDSC-adjusted
(or unadjusted) SE, Z, and P columns.
}
\details{
Prepare GWAS summary statistics for meta-analysis
}
\examples{
\dontrun{
out <- prep_gwas(
  sumstats_file = "cohort1.txt.gz",
  hm3           = hm3_snps,
  ancestry      = "EUR",
  output_path   = "Data/prepped",
  trait_type    = "binary",
  n_col         = EffectiveN
)
}

}
