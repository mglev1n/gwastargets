% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_common_variants.R
\name{extract_common_variants}
\alias{extract_common_variants}
\title{Extract variants common to all GWAS studies}
\usage{
extract_common_variants(
  parquet_files,
  trait_type,
  maf_threshold = 0.05,
  select_per_mb_window = FALSE,
  window_size_mb = 1,
  seed = NULL,
  eaf_col = EAF,
  chr_col = CHR,
  pos_col = POS_38,
  rsid_col = RSID,
  ea_col = EffectAllele,
  oa_col = OtherAllele,
  n_col = N
)
}
\arguments{
\item{parquet_files}{Character vector of paths to parquet files.}

\item{trait_type}{\code{"binary"} or \code{"quantitative"} (required).}

\item{maf_threshold}{Minimum minor allele frequency. Default \code{0.05}.}

\item{select_per_mb_window}{Logical; if \code{TRUE}, select one variant per
\code{window_size_mb} Mb window per chromosome. Default \code{FALSE}.}

\item{window_size_mb}{Window size in megabases for thinning. Default \code{1}.}

\item{seed}{Random seed for reproducible window selection. Default \code{NULL}.}

\item{eaf_col}{Bare column name for EAF. Default \code{EAF}.}

\item{chr_col}{Bare column name for chromosome. Default \code{CHR}.}

\item{pos_col}{Bare column name for position. Default \code{POS_38}.}

\item{rsid_col}{Bare column name for rsid. Default \code{RSID}.}

\item{ea_col}{Bare column name for effect allele. Default \code{EffectAllele}.}

\item{oa_col}{Bare column name for other allele. Default \code{OtherAllele}.}

\item{n_col}{Bare column name for N. Default \code{N}.}
}
\value{
A \code{\link[tibble:tibble]{tibble::tibble()}} with columns \code{file}, chromosome, position,
rsid, effect allele, other allele, and \code{minor_af}. One row per
variant Ã— study combination.
}
\description{
Opens multiple parquet files, filters to variants with minor allele
frequency above \code{maf_threshold}, and returns only variants present in
every file. Optionally selects one variant per megabase window per
chromosome for LD-thinned analyses.
}
\details{
Extract common variants present in all studies
}
\examples{
\dontrun{
common <- extract_common_variants(
  parquet_files = c("study1.parquet", "study2.parquet"),
  trait_type    = "binary"
)
}

}
