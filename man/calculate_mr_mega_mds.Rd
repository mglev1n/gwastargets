% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_mr_mega_mds.R
\name{calculate_mr_mega_mds}
\alias{calculate_mr_mega_mds}
\title{Calculate MR-MEGA MDS coordinates from allele frequency data}
\usage{
calculate_mr_mega_mds(
  common_variants_data,
  pcCount = 4,
  chr_col = CHR,
  pos_col = POS_38,
  rsid_col = RSID,
  ea_col = EffectAllele,
  oa_col = OtherAllele,
  eaf_col = minor_af,
  file_col = file
)
}
\arguments{
\item{common_variants_data}{A data frame (long format) with one row per
variant × study combination. Must contain columns identified by
\code{chr_col}, \code{pos_col}, \code{ea_col}, \code{oa_col}, \code{eaf_col}, and \code{file_col}.
Typically the output of \code{\link[=extract_common_variants]{extract_common_variants()}}.}

\item{pcCount}{Number of principal coordinates to return. Default \code{4}.}

\item{chr_col}{Bare column name for chromosome. Default \code{CHR}.}

\item{pos_col}{Bare column name for position. Default \code{POS_38}.}

\item{rsid_col}{Bare column name for rsid. Default \code{RSID}.}

\item{ea_col}{Bare column name for effect allele. Default \code{EffectAllele}.}

\item{oa_col}{Bare column name for other allele. Default \code{OtherAllele}.}

\item{eaf_col}{Bare column name for EAF. Default \code{minor_af}.}

\item{file_col}{Bare column name for study/file identifier. Default \code{file}.}
}
\value{
A named list with elements:
\describe{
\item{\code{pc_coordinates}}{Data frame of MDS coordinates (\code{pcCount} columns).}
\item{\code{distance_matrix}}{Population-genetic distance matrix.}
\item{\code{centered_distance_matrix}}{Double-centred distance matrix.}
\item{\code{eigenvalues}}{Eigenvalues from SVD.}
\item{\code{eaf_matrix}}{Wide EAF matrix (variants × studies).}
\item{\code{used_variants}}{Variants with complete EAF data.}
\item{\code{studies}}{Character vector of study names.}
\item{\code{summary}}{List with \code{n_studies}, \code{n_variants_used},
\code{n_variants_total}, \code{pc_count}.}
}
}
\description{
Computes multidimensional scaling (MDS) coordinates from study-level effect
allele frequency (EAF) data. The approach follows the MR-MEGA method
(Mägi et al. 2017): a population-genetic distance matrix is computed from
EAF values, double-centred, and decomposed via SVD to produce principal
coordinates.
}
\details{
Calculate MR-MEGA multidimensional scaling coordinates
}
\examples{
\dontrun{
common <- extract_common_variants(files, trait_type = "binary")
mds    <- calculate_mr_mega_mds(common)
}

}
\references{
Mägi R, et al. (2017). Trans-ethnic meta-regression of genome-wide
association studies accounting for ancestry increases power for discovery
and improves fine-mapping resolution. \emph{Hum Mol Genet}, 26(18), 3639–3650.
}
